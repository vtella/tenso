<?xml version="1.0" encoding="UTF-8"?>
<odoo>
        <record id="view_hr_payslip_form" model="ir.ui.view">
            <field name="name">hr.payslip.nomina</field>
            <field name="model">hr.payslip</field>
            <field name="inherit_id" ref="hr_payroll.view_hr_payslip_form"/>
            <field name="arch" type="xml">
              <field name="credit_note" position="after">
					<field name="tipo_nomina" />
				    <field name="fecha_pago" />
				    <field name="nomina_cfdi" invisible="1"/>
				</field>
				<xpath expr="//notebook" position="inside">
                <page name="info_cdfi" string="CFDI 3.3">
                        <group cols="4">
                            <group string="CotizaciÃ³n al IMSS">
                            	<field name="imss_dias"/>
                            	<field name="imss_mes"/>
                            </group>
							 <group string="Datos CFDI">
                            	<field name="forma_pago"/>
                            	<field name="tipo_comprobante"/>
                            	<field name="methodo_pago"/>
                            	<field name="uso_cfdi"/>
                            </group>
							 <group string="CFDI Relacionados">
                            	<field name="tipo_relacion"/>
                            	<field name="uuid_relacionado"/>
                            </group>
                            <group  string="Detalles de Factura">
                                	<field name="folio_fiscal"/>
                                	<field name="estado_factura"/>
                                </group>
                        </group>
                </page>
			</xpath>
				
				<button name="action_payslip_cancel" position="before">
                	<button name="action_cfdi_nomina_generate" type="object" string="Generar CFDI" 
                			attrs="{'invisible':['|',('estado_factura','=','factura_correcta'),('state','!=','done')]}"
                			class="oe_highlight" groups="base.group_user"/>
                   <button name="action_cfdi_cancel" type="object" string="Cancelar CFDI" 
						    attrs="{'invisible':['|',('nomina_cfdi','=',False), ('estado_factura','=','factura_cancelada')]}" 
						    class="oe_highlight" groups="base.group_user"/>
				   <button name="send_nomina" class="oe_highlight" attrs="{'invisible':[('estado_factura','!=','factura_correcta')]}" string="Enviar por correo" type="object"/>
                </button>
            </field>
        </record>
       
       <record id="hr_payslip_run_form_nomina_cfdi" model="ir.ui.view">
            <field name="name">hr.payslip.run.form.nomina</field>
            <field name="model">hr.payslip.run</field>
            <field name="inherit_id" ref="hr_payroll.hr_payslip_run_form"/>
            <field name="arch" type="xml">
            	<button name="draft_payslip_run" position="after">
            		<field name="all_payslip_generated" invisible="1" />
            		<button string="Timbrar Nomina" name="timbrar_nomina" type="object" attrs="{'invisible':[('all_payslip_generated','=',True)]}" class="oe_highlight"/>
            		<button string="Enviar Nomina" name="enviar_nomina" type="object" attrs="{'invisible':[('all_payslip_generated','!=',True)]}" class="oe_highlight"/>
            	</button>
            </field>
       </record> 
        
</odoo>